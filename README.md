# 贪吃蛇游戏（C++ & EasyX）

## 项目介绍
这是一个基于 C++ 语言和 EasyX 图形库开发的经典贪吃蛇游戏。采用面向对象编程（OOP）思想设计，实现了贪吃蛇的核心玩法：方向键控制移动、吃食物增长身体、碰撞自身判定游戏结束，界面简洁流畅，适合作为 C++ 面向对象与图形编程的学习案例。


## 技术栈
| 类型         | 工具/库                | 说明                                                                 |
|--------------|------------------------|----------------------------------------------------------------------|
| 编程语言     | C++                    | 核心开发语言，利用封装、继承、多态等面向对象特性构建代码结构         |
| 图形渲染     | EasyX 图形库           | 提供窗口创建、图形绘制（矩形/圆形）、键盘消息处理等可视化功能       |
| 数据存储     | STL vector（顺序表）   | 存储蛇的身体节点，支持动态添加（身体增长）与遍历（绘制/碰撞检测）   |
| 随机数生成   | ctime 库               | 通过 `time(nullptr)` 初始化随机数种子，实现食物的随机位置生成       |


## 类结构设计
项目通过 4 个核心类实现功能模块化，类间通过**继承**实现代码复用，通过**组合**实现功能整合，结构如下：

### 1. 基类：`Sprite`（精灵类）
- **定位**：所有「可绘制游戏对象」的抽象基类，封装通用属性与方法
- **核心属性**：
  - `m_x`/`m_y`：对象坐标（单位：像素，与蛇身/食物尺寸对齐）
  - `m_color`：对象颜色（默认红色）
- **核心方法**：
  - `draw()`：虚函数，默认绘制 10×10 红色矩形（子类可重写）
  - `moveBy(int dx, int dy)`：按偏移量 `dx`/`dy` 移动对象
  - `collision(const Sprite& other)`：检测当前对象与另一对象是否碰撞（坐标重合判定）

### 2. 子类：`Snake`（蛇类）
- **继承关系**：公有继承 `Sprite` 类
- **定位**：实现蛇的移动、身体管理、自身碰撞检测
- **核心属性**：
  - `vector<Sprite> nodes`：存储蛇的所有身体节点（`nodes[0]` 为蛇头，后续为蛇身）
  - `dir`：移动方向（默认向右，取值：`VK_UP`/`VK_DOWN`/`VK_LEFT`/`VK_RIGHT`）
- **核心方法**：
  - `collision(const Sprite& other)`：重写基类方法，仅检测蛇头与其他对象的碰撞
  - `draw()`：重写基类方法，遍历绘制所有身体节点
  - `bodyMove()`：蛇的移动逻辑（身体节点跟随前一节点，蛇头按方向偏移）
  - `bodyadd()`：吃食物后增长身体（尾部添加新节点）
  - `collisionself()`：检测蛇头是否碰撞自身身体（遍历蛇身节点与蛇头比较）

### 3. 子类：`Food`（食物类）
- **继承关系**：公有继承 `Sprite` 类
- **定位**：实现食物的绘制与随机位置生成
- **核心方法**：
  - `draw()`：重写基类方法，绘制绿色圆形食物（`solidellipse` 函数）
  - `chagePos()`：随机生成食物坐标（范围：窗口 640×480 内，确保坐标为 10 的倍数，与蛇身对齐）

### 4. 场景类：`GameScense`（游戏场景类）
- **组合关系**：包含 `Snake snake` 和 `Food food` 两个对象实例
- **定位**：整合游戏元素，控制主循环、消息处理、碰撞判定
- **核心方法**：
  - `run()`：游戏主逻辑（双缓冲绘图、蛇/食物绘制、移动、碰撞检测）
  - `onMsg(const ExMessage& msg)`：处理键盘消息（控制蛇的方向，防止反向移动）
  - `eatFood()`：检测蛇头是否吃食物（吃到则增长身体并刷新食物位置）
  - `gameover()`：游戏结束判定（检测蛇头碰撞自身，触发则输出提示并退出）


## 类的继承与组合关系图
```
          [Sprite]  <-- 基类
           /    \
          /      \
[Snake 类]      [Food 类]  <-- 继承：复用 Sprite 的属性与方法
     |              |
     |              |
     +--------------+
                    |
            [GameScense 类]  <-- 组合：包含 Snake 和 Food 实例，整合游戏逻辑
```


## 游戏运行流程
1. **初始化阶段**：
   - 调用 `initgraph(640, 480, EX_SHOWCONSOLE)` 创建 640×480 像素窗口（显示控制台）
   - 调用 `srand(time(nullptr))` 初始化随机数种子（用于食物位置生成）
   - 创建 `GameScense` 实例，自动初始化蛇（初始 3 节身体，默认向右）和食物（随机位置）

2. **主循环阶段**（`while(true)`）：
   1. 双缓冲绘图：`BeginBatchDraw()` 开始绘图，`cleardevice()` 清屏，避免闪烁
   2. 绘制元素：调用 `snake.draw()` 和 `food.draw()` 绘制蛇与食物
   3. 碰撞检测：调用 `eatFood()` 检测吃食物，调用 `gameover()` 检测自身碰撞
   4. 结束绘图：`EndBatchDraw()` 刷新画面
   5. 蛇移动：调用 `snake.bodyMove()` 更新蛇的位置
   6. 消息处理：监听方向键输入，更新蛇的移动方向（防止反向）
   7. 速度控制：`Sleep(100)` 控制游戏速度（数值越小，速度越快）

3. **游戏结束阶段**：
   - 当 `snake.collisionself()` 检测到蛇头碰撞自身时，控制台输出 `gameover`
   - 调用 `exit(0)` 退出程序


## 运行说明
### 环境要求
- 操作系统：Windows（EasyX 图形库仅支持 Windows）
- 编译工具：支持 C++11 及以上标准的编译器（如 Dev-C++、Visual Studio、Code::Blocks）
- 依赖库：EasyX 图形库（需提前安装，或在编译时引入 `easyx.h` 头文件与相关库文件）

### 操作方法
- 方向键 `↑`/`↓`/`←`/`→`：控制蛇的移动方向
- 蛇吃到绿色圆形食物后，身体自动增长一节，食物随机刷新位置
- 蛇头碰撞自身身体时，游戏结束并退出

